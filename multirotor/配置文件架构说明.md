# é…ç½®æ–‡ä»¶æ¶æ„è¯´æ˜

## ğŸ“‚ é…ç½®æ–‡ä»¶èŒè´£åˆ’åˆ†

ä¸ºäº†é¿å…é…ç½®å†—ä½™å’Œå¤æ‚æ€§ï¼Œæˆ‘ä»¬å°†é…ç½®æ–‡ä»¶æŒ‰èŒè´£è¿›è¡Œäº†åˆ†ç¦»ï¼š

### 1. `drones_config.json` - æ— äººæœºé…ç½®ï¼ˆæ ¸å¿ƒï¼‰
**ä½ç½®**: `multirotor/drones_config.json`

**èŒè´£**: ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ— äººæœºçš„åŸºç¡€é…ç½®å’Œè®­ç»ƒé€‰æ‹©

**åŒ…å«å†…å®¹**:
- æ— äººæœºåˆ—è¡¨åŠå…¶åŸºç¡€ä¿¡æ¯ï¼ˆç±»å‹ã€å¯ç”¨çŠ¶æ€ã€é•œåƒæ¨¡å¼ï¼‰
- DQN è®­ç»ƒä½¿ç”¨çš„æ— äººæœºé…ç½®
- DDPG è®­ç»ƒä½¿ç”¨çš„æ— äººæœºé…ç½®

**ç¤ºä¾‹é…ç½®**:
```json
{
  "description": "æ— äººæœºé…ç½®æ–‡ä»¶ - ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ— äººæœºçš„åŸºç¡€é…ç½®",
  "version": "1.0.0",
  
  "drones": {
    "UAV1": {
      "enabled": true,
      "type": "virtual",
      "isCrazyflieMirror": false,
      "description": "è™šæ‹Ÿæ— äººæœº1ï¼ˆAirSimï¼‰"
    },
    "UAV2": {
      "enabled": true,
      "type": "physical",
      "isCrazyflieMirror": true,
      "description": "å®ä½“æ— äººæœºï¼ˆCrazyflieï¼‰"
    }
  },
  
  "training": {
    "dqn": {
      "use_all_drones": false,
      "drone_list": ["UAV1"]
    },
    "ddpg": {
      "use_all_drones": true
    }
  }
}
```

**é…ç½®è¯´æ˜**:
- `enabled`: æ˜¯å¦å¯ç”¨è¯¥æ— äººæœº
- `type`: `virtual` (è™šæ‹Ÿæ— äººæœº AirSim) æˆ– `physical` (å®ä½“æ— äººæœº Crazyflie)
- `isCrazyflieMirror`: æ˜¯å¦ä¸º Crazyflie å®ä½“æ— äººæœºçš„é•œåƒï¼ˆç”¨äºè™šå®ååŒï¼‰
- `use_all_drones`: 
  - `true` - ä½¿ç”¨æ‰€æœ‰ `enabled=true` çš„æ— äººæœº
  - `false` - ä½¿ç”¨ `drone_list` æŒ‡å®šçš„æ— äººæœº
- `drone_list`: æŒ‡å®šè®­ç»ƒä½¿ç”¨çš„æ— äººæœºåç§°åˆ—è¡¨

---

### 2. `movement_dqn_config.json` - DQN ç®—æ³•é…ç½®
**ä½ç½®**: `multirotor/DQN_Movement/movement_dqn_config.json`

**èŒè´£**: ä»…ç®¡ç† DQN ç®—æ³•ç›¸å…³çš„å‚æ•°

**åŒ…å«å†…å®¹**:
- ç§»åŠ¨å‚æ•°ï¼ˆæ­¥é•¿ã€æœ€å¤§æ­¥æ•°ï¼‰
- å¥–åŠ±å‡½æ•°å‚æ•°
- é˜ˆå€¼å‚æ•°
- è®­ç»ƒè¶…å‚æ•°ï¼ˆå­¦ä¹ ç‡ã€æ‰¹æ¬¡å¤§å°ç­‰ï¼‰
- æ¨¡å‹ç»“æ„å‚æ•°
- è¯„ä¼°å‚æ•°

**ä¸å†åŒ…å«**: ~~æ— äººæœºé…ç½®ï¼ˆå·²ç§»è‡³ drones_config.jsonï¼‰~~

---

### 3. DDPG è®­ç»ƒé…ç½®æ–‡ä»¶
**ä½ç½®**: `multirotor/DDPG_Weight/*.json`

**èŒè´£**: ä»…ç®¡ç† DDPG ç®—æ³•ç›¸å…³çš„å‚æ•°

**åŒ…å«å†…å®¹**:
- DDPG ç½‘ç»œç»“æ„å‚æ•°
- è®­ç»ƒè¶…å‚æ•°
- å¥–åŠ±å‡½æ•°å‚æ•°
- æ¢ç´¢å™ªå£°å‚æ•°

**ä¸å†åŒ…å«**: ~~æ— äººæœºé…ç½®ï¼ˆå·²ç§»è‡³ drones_config.jsonï¼‰~~

---

### 4. `scanner_config.json` - APF ç®—æ³•é…ç½®
**ä½ç½®**: `multirotor/scanner_config.json`

**èŒè´£**: APF ç®—æ³•å‚æ•°å’Œç½‘æ ¼é…ç½®

**åŒ…å«å†…å®¹**:
- APF ç®—æ³•ç³»æ•°ï¼ˆå¸å¼•åŠ›ã€æ’æ–¥åŠ›ç­‰ï¼‰
- ç½‘æ ¼æ•°æ®é…ç½®
- æ‰«æåŒºåŸŸå‚æ•°

**å·²åºŸå¼ƒå­—æ®µ**: `droneSettings`ï¼ˆä¸ºäº†å‘åå…¼å®¹ä»ä¿ç•™ï¼Œä½†ä¸å†ä½¿ç”¨ï¼‰

---

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### Python ä»£ç ä¸­ä½¿ç”¨

```python
from Algorithm.drones_config import DronesConfig

# åŠ è½½æ— äººæœºé…ç½®
drones_config = DronesConfig()

# è·å–æ‰€æœ‰æ— äººæœº
all_drones = drones_config.get_all_drones()
print(f"æ‰€æœ‰æ— äººæœº: {all_drones}")

# è·å–å¯ç”¨çš„æ— äººæœº
enabled_drones = drones_config.get_enabled_drones()
print(f"å¯ç”¨çš„æ— äººæœº: {enabled_drones}")

# è·å– DQN è®­ç»ƒä½¿ç”¨çš„æ— äººæœº
dqn_drones = drones_config.get_training_drones('dqn')
print(f"DQNè®­ç»ƒæ— äººæœº: {dqn_drones}")

# è·å– DDPG è®­ç»ƒä½¿ç”¨çš„æ— äººæœº
ddpg_drones = drones_config.get_training_drones('ddpg')
print(f"DDPGè®­ç»ƒæ— äººæœº: {ddpg_drones}")

# è·å–å•ä¸ªæ— äººæœºä¿¡æ¯
drone_type = drones_config.get_drone_type('UAV1')
is_crazyflie = drones_config.is_crazyflie_mirror('UAV1')
is_enabled = drones_config.is_enabled('UAV1')
```

### DronesConfig API å‚è€ƒ

#### è·å–æ— äººæœºåˆ—è¡¨
- `get_all_drones()` - è¿”å›æ‰€æœ‰æ— äººæœºåç§°åˆ—è¡¨
- `get_enabled_drones()` - è¿”å›æ‰€æœ‰å¯ç”¨çš„æ— äººæœºåˆ—è¡¨
- `get_training_drones(algorithm)` - è¿”å›æŒ‡å®šç®—æ³•è®­ç»ƒä½¿ç”¨çš„æ— äººæœºåˆ—è¡¨
  - `algorithm`: `'dqn'` æˆ– `'ddpg'`

#### è·å–æ— äººæœºä¿¡æ¯
- `get_drone_info(drone_name)` - è¿”å›æŒ‡å®šæ— äººæœºçš„è¯¦ç»†ä¿¡æ¯å­—å…¸
- `get_drone_type(drone_name)` - è¿”å›æ— äººæœºç±»å‹ (`'virtual'` æˆ– `'physical'`)
- `is_crazyflie_mirror(drone_name)` - åˆ¤æ–­æ˜¯å¦ä¸ºå®ä½“æ— äººæœº (è¿”å› `True/False`)
- `is_enabled(drone_name)` - åˆ¤æ–­æ— äººæœºæ˜¯å¦å¯ç”¨ (è¿”å› `True/False`)

#### ä¿å­˜é…ç½®
- `save_config()` - ä¿å­˜ä¿®æ”¹åçš„é…ç½®åˆ°æ–‡ä»¶

---

## ğŸ“ ä¿®æ”¹è®­ç»ƒä½¿ç”¨çš„æ— äººæœº

### æ–¹å¼ 1: ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„æ— äººæœº

ç¼–è¾‘ `drones_config.json`:
```json
{
  "training": {
    "dqn": {
      "use_all_drones": true
    }
  }
}
```

### æ–¹å¼ 2: æŒ‡å®šç‰¹å®šæ— äººæœº

ç¼–è¾‘ `drones_config.json`:
```json
{
  "training": {
    "dqn": {
      "use_all_drones": false,
      "drone_list": ["UAV1", "UAV2"]
    }
  }
}
```

### æ–¹å¼ 3: ç¦ç”¨æŸä¸ªæ— äººæœº

ç¼–è¾‘ `drones_config.json`:
```json
{
  "drones": {
    "UAV2": {
      "enabled": false,
      "type": "virtual",
      "isCrazyflieMirror": false
    }
  }
}
```

---

## âœ¨ æ¶æ„ä¼˜åŠ¿

### 1. èŒè´£æ¸…æ™°
æ¯ä¸ªé…ç½®æ–‡ä»¶åªç®¡ç†è‡ªå·±é¢†åŸŸçš„å‚æ•°ï¼š
- `drones_config.json` â†’ æ— äººæœºç¡¬ä»¶é…ç½®
- `movement_dqn_config.json` â†’ DQN ç®—æ³•å‚æ•°
- DDPG é…ç½®æ–‡ä»¶ â†’ DDPG ç®—æ³•å‚æ•°
- `scanner_config.json` â†’ APF ç®—æ³•å‚æ•°

### 2. é¿å…å†—ä½™
æ— äººæœºé…ç½®åªéœ€åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰ï¼Œæ‰€æœ‰è®­ç»ƒè„šæœ¬å…±äº«åŒä¸€é…ç½®æºã€‚

### 3. æ˜“äºæ‰©å±•
- æ·»åŠ æ–°æ— äººæœºï¼šåªéœ€ä¿®æ”¹ `drones_config.json`
- æ·»åŠ æ–°ç®—æ³•ï¼šåˆ›å»ºæ–°çš„ç®—æ³•é…ç½®æ–‡ä»¶ï¼Œæ— éœ€é‡å¤å®šä¹‰æ— äººæœº

### 4. ç»Ÿä¸€ç®¡ç†
DQN å’Œ DDPG å…±äº«åŒä¸€ä¸ªæ— äººæœºé…ç½®æºï¼Œä¿è¯ä¸€è‡´æ€§ã€‚

### 5. çµæ´»åˆ‡æ¢
é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶è½»æ¾åˆ‡æ¢è®­ç»ƒä½¿ç”¨çš„æ— äººæœºï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚

---

## ğŸ”„ è¿ç§»æŒ‡å—

### ä»æ—§æ¶æ„è¿ç§»

å¦‚æœä½ ä¹‹å‰åœ¨ DQN/DDPG é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†æ— äººæœºä¿¡æ¯ï¼š

#### æ­¥éª¤ 1: å°†æ— äººæœºä¿¡æ¯è¿ç§»åˆ° drones_config.json

**æ—§é…ç½®** (movement_dqn_config.json):
```json
{
  "training_drones": {
    "use_all_drones": false,
    "drone_list": ["UAV1"]
  }
}
```

**æ–°é…ç½®** (drones_config.json):
```json
{
  "drones": {
    "UAV1": {
      "enabled": true,
      "type": "virtual",
      "isCrazyflieMirror": false
    }
  },
  "training": {
    "dqn": {
      "use_all_drones": false,
      "drone_list": ["UAV1"]
    }
  }
}
```

#### æ­¥éª¤ 2: ä»ç®—æ³•é…ç½®æ–‡ä»¶ä¸­åˆ é™¤æ— äººæœºé…ç½®

åˆ é™¤ `movement_dqn_config.json` ä¸­çš„ `training_drones` å­—æ®µã€‚

#### æ­¥éª¤ 3: æ›´æ–°ä»£ç ä½¿ç”¨ DronesConfig

**æ—§æ–¹å¼** (å·²åºŸå¼ƒ):
```python
from Algorithm.scanner_config_data import ScannerConfigData
scanner_config = ScannerConfigData(config_file)
drone_names = scanner_config.get_drone_list()
```

**æ–°æ–¹å¼** (æ¨è):
```python
from Algorithm.drones_config import DronesConfig
drones_config = DronesConfig()
drone_names = drones_config.get_training_drones('dqn')
```

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

### 1. DQN å¤šæ™ºèƒ½ä½“æ”¯æŒ
**å½“å‰ DQN æ”¯æŒä¸¤ç§è®­ç»ƒæ¨¡å¼**ï¼š
- **å•æœºè®­ç»ƒ**ï¼šé…ç½® 1 ä¸ªæ— äººæœºæ—¶ï¼Œä½¿ç”¨ `MovementEnv`
- **å¤šæœºè®­ç»ƒï¼ˆå‚æ•°å…±äº«ï¼‰**ï¼šé…ç½®å¤šä¸ªæ— äººæœºæ—¶ï¼Œä½¿ç”¨ `MultiDroneMovementEnv`
  - å¤šä¸ªæ— äººæœºè½®æµæ‰§è¡ŒåŠ¨ä½œ
  - å…±äº«åŒä¸€ä¸ª DQN æ¨¡å‹å‚æ•°
  - æ‰€æœ‰æ— äººæœºå­¦ä¹ ç›¸åŒçš„ç­–ç•¥
  - é€‚åˆåŒè´¨åŒ–å¤šæœºååŒä»»åŠ¡

ç³»ç»Ÿä¼šæ ¹æ® `drones_config.json` ä¸­é…ç½®çš„æ— äººæœºæ•°é‡è‡ªåŠ¨é€‰æ‹©ç¯å¢ƒç±»å‹ã€‚

### 2. DDPG å¤šæ™ºèƒ½ä½“æ”¯æŒ
DDPG æ”¯æŒå¤šæ— äººæœºååŒè®­ç»ƒï¼Œå¯ä»¥é…ç½®å¤šä¸ªæ— äººæœºã€‚

### 3. é…ç½®éªŒè¯æœºåˆ¶
`DronesConfig` ç±»ä¼šè‡ªåŠ¨éªŒè¯ï¼š
- æ— äººæœºæ˜¯å¦å­˜åœ¨äºé…ç½®ä¸­
- æ— äººæœºæ˜¯å¦å·²å¯ç”¨
- æ— æ•ˆé…ç½®ä¼šè¢«è·³è¿‡å¹¶ç»™å‡ºè­¦å‘Š

### 4. å‘åå…¼å®¹
`scanner_config.json` ä¸­çš„ `droneSettings` å­—æ®µä»ä¿ç•™ï¼Œä½†å·²æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆDeprecatedï¼‰ã€‚æ–°ä»£ç ä¸åº”ä½¿ç”¨è¯¥å­—æ®µã€‚

### 5. é…ç½®æ–‡ä»¶ä½ç½®
æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½ä½äº `multirotor/` ç›®å½•ä¸‹ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†ã€‚

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é›†ä¸­ç®¡ç†æ— äººæœºé…ç½®
æ‰€æœ‰æ— äººæœºçš„æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤éƒ½åœ¨ `drones_config.json` ä¸­è¿›è¡Œã€‚

### 2. ä½¿ç”¨ DronesConfig ç±»
åœ¨ä»£ç ä¸­å§‹ç»ˆä½¿ç”¨ `DronesConfig` ç±»è€Œä¸æ˜¯ç›´æ¥è¯»å– JSON æ–‡ä»¶ã€‚

### 3. éªŒè¯é…ç½®æœ‰æ•ˆæ€§
åœ¨å¯åŠ¨è®­ç»ƒå‰ï¼Œæ£€æŸ¥è¿”å›çš„æ— äººæœºåˆ—è¡¨æ˜¯å¦ä¸ºç©ºï¼š
```python
drones = drones_config.get_training_drones('dqn')
if not drones:
    print("é”™è¯¯: æ²¡æœ‰å¯ç”¨çš„è®­ç»ƒæ— äººæœº")
    sys.exit(1)
```

### 4. ä¿æŒé…ç½®åŒæ­¥
ä¿®æ”¹æ— äººæœºé…ç½®åï¼Œç¡®ä¿æ‰€æœ‰è®­ç»ƒè„šæœ¬éƒ½èƒ½æ­£ç¡®è¯»å–æ–°é…ç½®ã€‚

### 5. æ–‡æ¡£æ›´æ–°
æ·»åŠ æ–°æ— äººæœºæ—¶ï¼Œæ›´æ–°é¡¹ç›®æ–‡æ¡£è¯´æ˜å…¶ç”¨é€”å’Œé…ç½®ã€‚

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è®­ç»ƒè„šæœ¬æ‰¾ä¸åˆ°æ— äººæœº

**ç—‡çŠ¶**: é”™è¯¯ä¿¡æ¯ "æ²¡æœ‰å¯ç”¨çš„è®­ç»ƒæ— äººæœº"

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ `drones_config.json` ä¸­æ— äººæœºæ˜¯å¦å·²å¯ç”¨ (`enabled: true`)
2. æ£€æŸ¥ `training.dqn.drone_list` ä¸­çš„æ— äººæœºåç§°æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ— äººæœºåç§°æ‹¼å†™æ˜¯å¦ä¸ `drones` å—ä¸­å®šä¹‰çš„ä¸€è‡´

### é—®é¢˜ 2: é…ç½®ä¿®æ”¹ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**: ä¿®æ”¹é…ç½®åè®­ç»ƒä»ä½¿ç”¨æ—§é…ç½®

**æ’æŸ¥æ­¥éª¤**:
1. ç¡®è®¤ä¿®æ”¹çš„æ˜¯æ­£ç¡®çš„é…ç½®æ–‡ä»¶ï¼ˆ`drones_config.json`ï¼‰
2. æ£€æŸ¥ JSON æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆä½¿ç”¨ JSON éªŒè¯å·¥å…·ï¼‰
3. é‡å¯è®­ç»ƒè„šæœ¬ï¼Œç¡®ä¿é‡æ–°åŠ è½½é…ç½®

### é—®é¢˜ 3: è™šå®æ··åˆé…ç½®é”™è¯¯

**ç—‡çŠ¶**: å®ä½“æ— äººæœºè¢«è¯†åˆ«ä¸ºè™šæ‹Ÿæ— äººæœºï¼ˆæˆ–åä¹‹ï¼‰

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ `isCrazyflieMirror` å­—æ®µæ˜¯å¦æ­£ç¡®è®¾ç½®
2. ç¡®è®¤ `type` å­—æ®µä¸å®é™…ç¡¬ä»¶ç±»å‹ä¸€è‡´
3. ä½¿ç”¨ `drones_config.get_drone_info()` éªŒè¯é…ç½®

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- **é…ç½®ç±»**: `multirotor/Algorithm/drones_config.py`
- **é…ç½®æ–‡ä»¶**: `multirotor/drones_config.json`
- **DQN è®­ç»ƒ**: `multirotor/DQN_Movement/train_movement_with_airsim.py`
- **DDPG è®­ç»ƒ**: `multirotor/DDPG_Weight/train_with_*.py`
- **æ ¸å¿ƒæœåŠ¡**: `multirotor/AlgorithmServer.py`

---

## ğŸ†• ç‰ˆæœ¬å†å²

### v1.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ… åˆ›å»ºç‹¬ç«‹çš„ `drones_config.json` é…ç½®æ–‡ä»¶
- âœ… å®ç° `DronesConfig` é…ç½®ç®¡ç†ç±»
- âœ… è¿ç§» BatteryManagerã€CrazyswarmManagerã€AlgorithmServer
- âœ… æ›´æ–° DQN å’Œ DDPG è®­ç»ƒè„šæœ¬
- âœ… åºŸå¼ƒ `scanner_config.json` ä¸­çš„ `droneSettings` å­—æ®µ

### æœªæ¥è§„åˆ’
- ğŸ“‹ å®Œå…¨ç§»é™¤ `droneSettings` å­—æ®µï¼ˆå¾…æ‰€æœ‰é—ç•™ä»£ç è¿ç§»å®Œæˆï¼‰
- ğŸ“‹ æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åŠ è½½é…ç½®
- ğŸ“‹ æ·»åŠ é…ç½®æ ¡éªŒå·¥å…·
- ğŸ“‹ æ”¯æŒé…ç½®ç‰ˆæœ¬ç®¡ç†
